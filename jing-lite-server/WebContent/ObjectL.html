<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<style type="text/css">
.field_key {
	font-size: 30px;
	font-weight: bold;
}

.field_value {
	font-size: 18px;
}
</style>

<script>
	function get_sha1() {
		var url = document.URL;
		var k = "?k=";
		var i = url.indexOf("?k=", 0);
		return url.substring(i + k.length, url.length);
	}

	function on_http_result(code, msg, text) {
		switch (code) {
		case 200: {
			var json = eval('(' + text + ')');
			var temp_row = document.getElementById("row_temp");
			var temp_k = document.getElementById("key_temp");
			var temp_v = document.getElementById("value_temp");
			var table = document.getElementById("table");
			temp_row.style.display = "none";
			table.innerHTML = "";
			for ( var key in json) {
				var value = json[key];
				//		alert(key + " = " + value);

				var row = temp_row.cloneNode(false);
				var k = temp_k.cloneNode(true);
				var v = temp_v.cloneNode(true);

				row.innerHTML = "";
				k.innerHTML = key;
				v.innerHTML = value + "";

				row.appendChild(k);
				row.appendChild(v);

				row.style.display = "block";
				table.appendChild(row);

			}
			break;
		}
		default:
			var out = document.getElementById("out_code");
			out.innerHTML = "HTTP " + code + " " + msg;
			break;
		}
	}

	function load_json_data() {
		var url = "ObjectJSON?k=" + get_sha1();
		var http = new XMLHttpRequest();
		http.open("GET", url, true);
		{
			//		http.readyState;
			//	http.status
			//			http.responseText ;
		}
		http.onreadystatechange = function(event) {
			var http = event.target;
			if (http.readyState == 4) {
				//		alert("status = " + http.status);
				on_http_result(http.status, http.statusText, http.responseText);
			}
		};
		http.send("");
		return url;
	}

	function on_load() {
		var url = load_json_data();
		var out = document.getElementById("out_url");
		//	out.innerHTML = url;
	}
</script>
</head>
<body onload="on_load()">
	<h1>
		<p>~Jing!</p>
	</h1>

	<div>
		<div id="out_url"></div>
		<div id="out_code"></div>
	</div>
	<p>
		<a href="http://puyatech.com/jing/download/">下载 ~Jing! 客户端</a>
	</p>

	<div id='table_temp'>
		<div id='row_temp'>
			<div id='key_temp' class='field_key'>key</div>
			<div id='value_temp' class='field_value'>value</div>
		</div>

	</div>

	<div id='table'></div>

</body>
</html>
